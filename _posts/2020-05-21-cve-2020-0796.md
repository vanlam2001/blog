---
title: CVE-2020-0796
date: 25/5/2021
layout: single
header:
  teaser: /assets/images/cve-2020-0796.png
--- 
---
## 0day Windows 10
[![Language](https://img.shields.io/badge/Lang-Python-blue.svg)](https://www.python.org)


--- 


# Giới Thiệu
Khai thác lỗ hổng CVE 2020-0796 trên Windows 10

# Mô Tả 
Các nhà nghiên cứu bảo mật của Ricerca Security  công bố PoC khai thác lỗ hổng thực thi mã từ xa CVE 2020-0796 (RCE) trên Windows 10. RCE được đánh giá là lỗi nghiêm trọng cao nhất trong kiểm thử ứng dụng/phần mềm.
Lỗ hổng này còn gọi là SMBGhost được phát hiện từ đầu tháng 3/2020 nằm trong giao thức SMBv3, và ảnh hưởng đến các phiên bản Windows 10, Core Windows Server, version 1903 và 1909.



## Mã Kiểm Tra 
Nhập python file-name.py địa chỉ Ip máy 

```python
# -*- coding: utf-8 -*- 
import struct
import sys
import socket

sock = socket.socket(socket.AF_INET)
sock.settimeout(4)
sock.connect((sys.argv[1],  445))

packet = b'\x00\x00\x00\xc0\xfeSMB@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00$\x00\x08\x00\x01\x00\x00\x00\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00x\x00\x00\x00\x02\x00\x00\x00\x02\x02\x10\x02"\x02$\x02\x00\x03\x02\x03\x10\x03\x11\x03\x00\x00\x00\x00\x01\x00&\x00\x00\x00\x00\x00\x01\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\n\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00'

sock.send(packet)

nb, = struct.unpack(">I", sock.recv(4))
result = sock.recv(nb)

if not result[68:70] == b"\x11\x03":
    exit("Không dễ bị tổn thương")
if not result[70:72] == b"\x02\x00":
    exit("Không dễ bị tổn thương")

exit("Dễ bị tổn thương")
```

![](/assets/images/cve-2020-0796.png)
## Nếu scan chương trình ghi dễ bị tổn thương thì nên cập nhật gấp :D 
## Đây là công cụ hacker thực thi mã từ xa nếu không cập nhật 

![demo](https://github.com/jiansiting/CVE-2020-0796/blob/master/demo.gif?raw=true)



## Mở powershell run as administrator và run 2 lệnh bên dưới
```bash
$ Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" DisableCompression -Type DWORD -Value 1 -Force
$ gpupdate /force
```
## Ngăn chặn càng sớm càng tốt :D
